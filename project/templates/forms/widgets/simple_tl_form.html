<div class="modal" id="modalFormTodo">
    <div class="modalContent">
        <span class="closeBtn">&times;</span>
        <h2>Add a Simple TodoList</h2>
        <form class="form" id="todoForm" method="post" action="{% url 'add_simple_todo' %}">
            {% csrf_token %}
            <div class="form--field">
                <label for="title">Title :</label>
                <input type="text" id="title" name="title" placeholder="Widget's Title">
            </div>
            <button class="formBtn" type="submit" name="simple_todo_form">Add widget</button>
        </form>
    </div>
</div>
<script>
 document.addEventListener("DOMContentLoaded", function() {
        const todoForm = document.getElementById("todoForm");
        console.log('yeaah')
        // Intercepter l'événement de soumission du formulaire
        todoForm.addEventListener("submit", function(event) {
            addSimpleTodoList(event); // Appelle la fonction au lieu de soumettre le formulaire normalement
        });
    });

    function addSimpleTodoList(event) {
        event.preventDefault(); // Empêche le rechargement de la page

        const title = document.getElementById("title").value;
        console.log("title: ", title);

        fetch("{% url 'add_simple_todo' %}", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                "X-CSRFToken": "{{ csrf_token }}" // Utilise le token CSRF pour la sécurité
            },
            body: JSON.stringify({ title: title })
        })
        .then(response => response.json())
        .then(data => {
            if (data.error) {
                alert("Erreur : " + data.error);
            } else {
                alert(data.message); // Affiche un message de succès
                document.getElementById("title").value = ""; // Réinitialise le champ de saisie
            }
        })
        .catch(error => {
            console.error("Erreur lors de l'ajout de la todo list :", error);
        });
    }
</script>